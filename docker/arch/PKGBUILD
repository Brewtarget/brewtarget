# Based on [brewtarget-git](https://aur.archlinux.org/packages/brewtarget-git/)

_pkgname=brewtarget
pkgname=brewtarget-devel
pkgver=2.3.1.r422.g596acfc
pkgrel=1
pkgdesc="Beer calculator compatible with BeerSmith. Generates instructions from the recipe and interactive mash designer."
url="http://www.brewtarget.org/"
arch=('x86_64')
license=('GPL3' 'custom:WTFPL-2')
depends=('qt5-tools' 'qt5-multimedia' 'qt5-webkit' 'qt5-svg')
optdepends=()
makedepends=('cmake' 'git')
conflicts=(brewtarget brewtarget-git)
provides=(brewtarget)
backup=()
source=("git+file:///app/brewtarget")
md5sums=('SKIP')

pkgver() {
  cat /app/arch/VERSION
}

build() {
  mkdir -p "${_pkgname}-build"
  cd "${_pkgname}-build"
  cmake "../${_pkgname}" -DCMAKE_INSTALL_PREFIX=/usr
  make
}

check() {
  cd "${_pkgname}-build"
  # QT_QPA_PLATFORM=minimal make test
}

package() {
  cd "${_pkgname}-build"
  make DESTDIR="${pkgdir}" install
  install -Dm644 "../${_pkgname}/COPYING.WTFPL" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE.WTFPL"
}
